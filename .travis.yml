language: java
jdk:
- oraclejdk8
branches:
  except:
  - travis
notifications:
  irc:
    channels:
    - chat.freenode.net#craftercms
    use_notice: true
    skip_join: true
  slack: craftersoftware:7YiSb41ZG5rfMgiAY7Qgprc7
addons:
  sonarqube: true
env:
  global:
  - secure: auWD3lOzro0DxUhrcE/DSg8tv6vyTK4HAIJHfh5z4uTnFt4tJ1BV8iiPunfKsNvcT2RSL85JCfvJd8ljDMe8XqywmkoED8lznUc9eFmj5YAGZEXRP8aYTo5UANYWWTkIBdsCacuCHJSAy7rNIU1WE+gqxGgZN1Kegh54u0ZBy9K5Ya/NYMnHeogr30qz9k82VbYMjw/pbyRdHVSZ6ztaweueRHljJYcGR3iDiDHSxVSFK6Jh4IHWw9S+PDS+eoewzsj5fwpSxP7htpkHai5oiweahgp6vNo4UQdwR67glbsFIVQlGJxIkA7RHCbsdx1eEDsj8uOJCfSRmMe6RJ/8cKr+NI4Riafjq2Wh4WSAAlxelGvzmSlAw5zRNImo6M4Q4MRuKggjCDqZUhkyjF5KCEmoRj0DzToE0OE9kAQJwyIJLkvxeHAKTQpaw+Bem11KcUDn2NQ+IW842TqqsQgCRMKCYNT8oW0Je43MjV/WYJR++F8IafTaA4+WjUaoOTlEwh1fscCHx6mJZ/jEwu/SWEv5hK1FxPqw6J/H9K5ihBkSt1qjUs6Mr53EJqIvtCI6YPKf2f8wH4lkAEj5vgWb5qNZMeBzb+K3jP1LMcNOXxrb8En6V67nHXpH2nfPjbH2B2PYBP0axZFK4PvhgUVQDrZQXcZllAs4O9lBY1M7tjI=
  - secure: YWeZoqzlByTFQ435cefDn1hTai40K21Rr5ojJSxviq8nYVGujxsEa1LPnDVBNZhduxfubUJurDedNS6Nl2/c6kBekU1BHFQbACbvfjfUd96Cpck06LbI5fzowqbsA0ngiDWw2M8HxC9s5aFe5ATF06CjBbhZ1qlKnttmOXDKo/PmoUqJitZ24M9b/jfWnIaLRQ6amB3CM1ZXIk7LHrNr/PgcRPmF581P8qGIbvsZFul7jkCMKvSxyWNrvV0ydiDVKpCCy5kV0veSDebSKkuE/+rdJEMrvLHRm1xIMJiJD84KHmlK0vuQhfQCJHn2dBUFTcomNlVdgsSOZ2MOyXU5vmsq/vYYXkiyREQX9KYNjkyv+mMsjDI/+IexFtLg4EXrauG6GYQYm8SYixmwkrTZhWziPRWbf4zE7fZewcfI1JM+uwVb/DC8ervTrJYCRbNlcXVOP1n+7xJvN/x+rVrqHx/RYA7zYjeeu1/RA/Pj/s5sfDroxZofWUydG4oyD5Fj3mU8HBf1dx1CrtULKKAF12t79FtgdYkVprxYBhcvwgVIY2OeuvQtkf7JRKV2HqMMEpyH7OIc/llGqR3noyncAStSqkm2rJpJQmIFAnmIZ80joQnKMWMm1To+FtPRCKj96eT5dgLj/fUbzL+04s5Q1bpEXXOJN5wN7BGZ8amgplQ=
  - secure: 2yOZRUJIV4yDu7F6yxht5y+Jmc6vT4k+EeVJsqPeHOdlyVBlGcj+Ygdr8o46z1hGrOHhDOttbjVDJHrkOlfwpxgOd0L43Vy8NDLqeL7Tcdb5AMFdVzRP6ukas0f+0kSMjefQpQ+fxkT1cYt94pQJQG21xYxR+1TlD//+fpvNoNvFgR86OIOKM8bWp5n3MEV83AO43WK+VJYeifzS5bBKc2Rzqj8seyDXmsx65jnVgmOr1+bPs1qj4eNDklkmwKZSTcUi+ZfIQwXfuheezi1oeI7DQ07E9MBKNrwb/cvQRr1VC/kHsI+SET4f0aZhSrd84X1Uy/EYw1onV0WPIUafnqyH+1gJ3PdHOq2yEvySQpMrZtz+KOwDaB9v4+BcWpehZGSsqHB8kuiFc5f1Wzj3EDDrpOn+OFVm57rBNqr6owE9pgy5YAmmGGEiUAmQt/ahVz48It9kJeoH/KofrSOk9AFyGeIhaRnJ9XU7pkwFb4UtTWhpcJo456vb3yUZMaKLtGFTLYVxP8nxJLuGmp3PlHGiJF2uJ99d3/hpCtl6Ah9VQYp5f+uJ/ti4KPLeLHU1Tu6fnrrIXTiOh+Dnb7oUTYERX+EKN7pkDV+sY2UQvVIQ0vzZ+N6v15HM8/5ZBz6qIHuBEADjPivHPxnhOGhBjSSDwYg6X2Sq78KqINUFEAs=
before_install: git clone -b travis `git config --get remote.origin.url` target/travis
script:
script:
  - 'if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then bash -c  "mvn deploy --settings target/travis/settings.xml";  fi'
  - 'if [[ "$TRAVIS_PULL_REQUEST" = "false" ]]; then bash -c "mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar -Dsonar.host.url=https://sonarqube.com -Dsonar.login=$SONAR_TOKEN;" ;fi'
